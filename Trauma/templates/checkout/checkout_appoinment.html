{% extends 'Components/Base.html' %}
{% load static %}
{% block title %}Home{% endblock title %}
{% block BaseCSS %}
      <style>
            input[name="selected_patient_profile"]:checked ~ label{
                  border-color: #0755E9;
            }
      </style>
{% endblock BaseCSS %}
{% block baseBody %}
<main class="px-4 sm:px-6 md:px-8 py-7">
      <section class="max-w-[1100px] mx-auto flex gap-5 lg:flex-row flex-col">
            <div class="space-y-5 max-w-96 w-full">
                  <div class="h-[400px] w-full rounded-lg bg-center bg-cover bg-no-repeat"
                        style="background-image: url('{{doctor.profile_image}}');">
                  </div>
                  <div class="space-y-1">
                        <div class="flex items-center justify-between gap-1">
                              <a href="{% url 'DoctorProfilePage' doctor.slug %}" class="text-xl font-semibold underline text-[#151E2C] line-clamp-1">Dr. {{doctor.name}}</a>
                              {% if doctor.is_approved %}
                                    <div class="flex items-center gap-1 bg-[#05D57C] cursor-default py-1 px-2 rounded-full absolute md:static top-4 right-4">
                                          <svg width="11" height="15" viewBox="0 0 14 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M9.66374 5L1.99707 7.33333L3.99707 14H9.66374L12.3304 7.33333L9.66374 5Z" fill="white"/>
                                                <mask id="path-2-outside-1_289_1038" maskUnits="userSpaceOnUse" x="0" y="0" width="14" height="18" fill="black">
                                                <rect fill="white" width="14" height="18"/>
                                                <path d="M5.66667 12.6667L3 10L3.94 9.06L5.66667 10.78L10.06 6.38667L11 7.33333M7 2L1 4.66667V8.66667C1 12.3667 3.56 15.8267 7 16.6667C10.44 15.8267 13 12.3667 13 8.66667V4.66667L7 2Z"/>
                                                </mask>
                                                <path d="M5.66667 12.6667L3 10L3.94 9.06L5.66667 10.78L10.06 6.38667L11 7.33333M7 2L1 4.66667V8.66667C1 12.3667 3.56 15.8267 7 16.6667C10.44 15.8267 13 12.3667 13 8.66667V4.66667L7 2Z" fill="#05D57C"/>
                                                <path d="M3 10L2.29289 9.29289L1.58579 10L2.29289 10.7071L3 10ZM3.94 9.06L4.64574 8.35153L3.93863 7.64715L3.23289 8.35289L3.94 9.06ZM5.66667 10.78L4.96093 11.4885L5.66803 12.1928L6.37377 11.4871L5.66667 10.78ZM10.06 6.38667L10.7696 5.68206L10.0625 4.96995L9.35289 5.67956L10.06 6.38667ZM7 2L7.40614 1.08619L7 0.905682L6.59386 1.08619L7 2ZM1 4.66667L0.593861 3.75286L0 4.01679V4.66667H1ZM7 16.6667L6.76278 17.6381L7 17.696L7.23722 17.6381L7 16.6667ZM13 4.66667H14V4.01679L13.4061 3.75286L13 4.66667ZM6.37377 11.9596L3.70711 9.29289L2.29289 10.7071L4.95956 13.3738L6.37377 11.9596ZM3.70711 10.7071L4.64711 9.76711L3.23289 8.35289L2.29289 9.29289L3.70711 10.7071ZM3.23426 9.76847L4.96093 11.4885L6.3724 10.0715L4.64574 8.35153L3.23426 9.76847ZM6.37377 11.4871L10.7671 7.09377L9.35289 5.67956L4.95956 10.0729L6.37377 11.4871ZM9.3504 7.09127L10.2904 8.03794L11.7096 6.62873L10.7696 5.68206L9.3504 7.09127ZM6.59386 1.08619L0.593861 3.75286L1.40614 5.58048L7.40614 2.91381L6.59386 1.08619ZM0 4.66667V8.66667H2V4.66667H0ZM0 8.66667C0 12.7861 2.83594 16.6792 6.76278 17.6381L7.23722 15.6952C4.28406 14.9741 2 11.9472 2 8.66667H0ZM7.23722 17.6381C11.1641 16.6792 14 12.7861 14 8.66667H12C12 11.9472 9.71594 14.9741 6.76278 15.6952L7.23722 17.6381ZM14 8.66667V4.66667H12V8.66667H14ZM13.4061 3.75286L7.40614 1.08619L6.59386 2.91381L12.5939 5.58048L13.4061 3.75286Z" fill="#FDFDFD" mask="url(#path-2-outside-1_289_1038)"/>
                                          </svg>                                        
                                          <p class="text-white text-[10px]">Verified doctor</p>
                                    </div>
                              {% endif %}
                        </div>
                        <p class="line-clamp-5 text-[#3C3C3C] text-sm outfit-font">{{doctor.desc}}</p>
                  </div>
            </div>
            <form action="{% url 'BookAppointment_DoctorPage' %}" method='post' class="rounded-2xl relative relative flex-1 space-y-4">
                  {% comment %} <a href="{% url 'DoctorProfilePage' doctor.slug %}" class="border border-[#CACBE6] rounded-md flex min-w-[200px] w-full gap-2 overflow-hidden">
                        <div class="bg-center w-[86px] bg-cover bg-no-repeat" style="background-image: url(/media/Doctor/Files/2024-12/2aa95791-5eae-4559-9934-74d5b4cb5aeb.jpg);"></div>
                        <div class="py-2 pr-3 flex-1">
                            <p class="text-md font-medium text-[#151E2C] outfit-font line-clamp-1">Dr. Muhammad Usman Tariq</p>
                            <p class="text-[#111111] text-xs outfit-font line-clamp-1">Consultant Dental Surgeon</p>
                            <p class="text-[#05D57C] text-[23px] outfit-font font-semibold italic flex items-center gap-1">
                                3000 
                                <span class="font-medium text-[#151E2C] text-xs">PKR</span>
                            </p>
                        </div>
                  </a> {% endcomment %}
                  <div class="gap-3 items-start border border-[#CACBE6] rounded-lg flex min-w-[200px] w-full p-2">
                        <div class="w-[70px] h-[70px] rounded-full bg-center bg-no-repeat bg-cover" style="background-image: url('{{hospital.hospital.profile_image.file.url}}');"></div>
                        <div class="flex-1 space-y-0.5">
                            <div class="flex items-center justify-between">
                              <h3 class="text-[#151E2C] line-clamp-1 text-xl font-medium outfit-font">{{hospital.hospital.name}}</h3>
                              <span class="text-xs outfit-font text-[#0555E9] flex gap-1">
                                    <span class="whitespace-nowrap" showdistance="{{hospital.location.lat}},{{hospital.location.lng}}">(1.64 Km)</span>
                              </span>
                            </div>
                            <p class="line-clamp-2 text-[#111111] text-xs">{{hospital.location.name}}</p>
                        </div>
                  </div>
                  <div class="space-y-3">
                        <h4 class="text-[#151E2C] line-clamp-1 font-medium outfit-font">Selected Patient</h4>
                        <div class="flex items-center gap-2 flex-wrap">
                              {% for profile in request.user.patient_profiles %}
                                    <div>
                                          <input type="radio" class="hidden" name="selected_patient_profile" value="{{profile.id}}" id="patient-profile-{{profile.id}}" {% if forloop.counter == 1 %}checked{% endif %} >
                                          <label for="patient-profile-{{profile.id}}" class="border rounded-full px-3 py-1 outfit-font">
                                                {{profile.full_name}}
                                          </label>
                                    </div>
                              {% endfor %}
                              <div class="border border-[#151E2C] rounded-full px-3 py-1 outfit-font text-[#151E2C] text-sm max-w-max cursor-pointer select-none" onclick="Chose_another_patient()">
                                    + Chose another patient
                              </div>
                        </div>
                  </div>
                  <div class="px-5 py-4 rounded-lg bg-[#f4f6f9]">
                        <div class="flex items-center justify-between py-3 border-b border-[#CACBE6]">
                              <h4 class="text-[#151E2C] outfit-font font-medium text-sm">Appointment Date:</h4>
                              <p class="text-[#151E2C] outfit-font font-medium text-sm">{{request.GET.selected_date}}</p>
                        </div>
                        <div class="flex items-center justify-between py-3 border-b border-[#CACBE6]">
                              <h4 class="text-[#151E2C] outfit-font font-medium text-sm">Appointment Time:</h4>
                              <p class="text-[#151E2C] outfit-font font-medium text-sm">{{request.GET.selected_time}}</p>
                        </div>
                        <div class="flex items-center justify-between py-3 border-b border-[#CACBE6]">
                              <h4 class="text-[#151E2C] outfit-font font-medium text-sm">Speciality:</h4>
                              <p class="text-[#151E2C] outfit-font font-medium text-sm">{{doctor.specialities.0.name}}</p>
                        </div>
                        <div class="flex items-center justify-between py-3 border-b border-[#CACBE6]">
                              <h4 class="text-[#0555E9] outfit-font font-medium text-sm">Sub Total:</h4>
                              <p class="text-[#0555E9] outfit-font font-medium text-sm">Rs. {{FEE}}</p>
                        </div>
                        <div class="flex items-center justify-between py-3 border-b border-[#CACBE6]">
                              <h4 class="text-[#0555E9] outfit-font font-medium text-sm">Discount Applied:</h4>
                              <p class="text-[#0555E9] outfit-font font-medium text-sm">Rs. -{{DISCOUNT}}</p>
                        </div>
                        <div class="flex items-center justify-between py-3 border-b border-[#CACBE6]">
                              <h4 class="text-[#151E2C] outfit-font font-medium text-sm">Platform Fee:</h4>
                              <p class="text-[#151E2C] outfit-font font-medium text-sm">Rs.{{PLATFORM_FEE}}</p>
                        </div>
                        <div class="flex items-center justify-between py-3">
                              <h4 class="text-[#151E2C] outfit-font font-semibold text-sm">Grand Total:</h4>
                              <p class="text-[#000] outfit-font font-medium text-sm italic">Rs.{{GRANDTOTAL}}</p>
                        </div>
                        <div class="flex items-center gap-2 pt-6 pb-2">
                              {% csrf_token %}
                              <input class='hidden' name='doctor' value="{{request.GET.doctor}}" />
                              <input class='hidden' name='selected_date' value="{{request.GET.selected_date}}" />
                              <input class='hidden' name='doct_hospital' value="{{request.GET.doct_hospital}}" />
                              <input class='hidden' name='dr-appointment-slot' value="{{slot_id}}" />
                              <input class='hidden' name='selected_time' value="{{request.GET.selected_time}}" />
                              <button class="block w-full transition-all p-2 py-3 rounded-lg block bg-gradient-to-r from-[#0755E9] to-[#05DC75] text-white">
                                    <p class="text-center outfit-font">Confirm Appointment</p>
                              </button>
                        </div>
                  </div>
            </form>
            {% comment %}
            <div class="max-w-[440px] w-full">
                  <form class="rounded-xl border border-[#CACBE6] p-4 space-y-3">
                        <div class="space-y-1">
                              <p class="text-[#151E2C] text-sm font-medium outfit-font cursor-default">Promo Code</p>
                              <input type="text" placeholder="Enter Your Promo Code" required class="rounded-md w-full outline-none border border-[#CACBE6] px-3 py-2.5 text-sm text-[#151E2C] outfit-font">
                        </div>
                        <div class="flex ite justify-end">
                              <button class="rounded-md text-sm outfit-font text-white bg-gradient-to-r from-[#8F17F6] via-[#EB14E5] to-[#FC736D] px-5 py-2.5">
                                    Apply
                              </button>
                        </div>
                  </form>
            </div>
            <div class="max-w-96 w-full space-y-2">
                  <h3 class="text-[#151E2C] font-semibold text-lg outfit-font">Other Doctors</h3>
                  <div class="space-y-2">
                        <a href="" class="border border-[#CACBE6] rounded-md flex min-w-[200px] max-w-[700px] w-full gap-2 overflow-hidden">
                              <div class="bg-center w-[86px] bg-cover bg-no-repeat" style="background-image: url(/media/Doctor/Files/2024-12/2aa95791-5eae-4559-9934-74d5b4cb5aeb.jpg);"></div>
                              <div class="py-2 pr-3 flex-1">
                                  <p class="text-md font-medium text-[#151E2C] outfit-font line-clamp-1">Dr. Muhammad Usman Tariq</p>
                                  <p class="text-[#111111] text-xs outfit-font line-clamp-1">Consultant Dental Surgeon</p>
                                  <p class="text-[#05D57C] text-[23px] outfit-font font-semibold italic flex items-center gap-1">
                                      3000 
                                      <span class="font-medium text-[#151E2C] text-xs">PKR</span>
                                  </p>
                              </div>
                        </a>
                        <a href="" class="border border-[#CACBE6] rounded-md flex min-w-[200px] max-w-[700px] w-full gap-2 overflow-hidden">
                              <div class="bg-center w-[86px] bg-cover bg-no-repeat" style="background-image: url(/media/Doctor/Files/2024-12/2aa95791-5eae-4559-9934-74d5b4cb5aeb.jpg);"></div>
                              <div class="py-2 pr-3 flex-1">
                                  <p class="text-md font-medium text-[#151E2C] outfit-font line-clamp-1">Dr. Muhammad Usman Tariq</p>
                                  <p class="text-[#111111] text-xs outfit-font line-clamp-1">Consultant Dental Surgeon</p>
                                  <p class="text-[#05D57C] text-[23px] outfit-font font-semibold italic flex items-center gap-1">
                                      3000 
                                      <span class="font-medium text-[#151E2C] text-xs">PKR</span>
                                  </p>
                              </div>
                        </a>
                  </div>
            </div>
            {% endcomment %}
      </section>
</main>


<section class="fixed left-[50%] -top-[50%] transition-all duration-500 rounded-xl sm:rounded-2xl border border-[#CACBE6] max-w-[420px] w-[94%] sm:w-full bg-white -translate-x-[50%] -translate-y-[50%] z-50" id="Chose_another_patient_main">
      <div class="flex items-center justify-end px-3 sm:px-4 py-2 sm:py-3">
            <span class="size-6 flex items-center justify-center cursor-pointer" onclick="Chose_another_patient_cancle()">
                  <svg class="size-5 fill-[#151E2C]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/></svg>
            </span>
      </div>
      <form class="px-3 sm:px-4 py-2 sm:py-3 space-y-4">
            <div class="space-y-1">
                  <label class="text-[#151E2C] text-sm outfit-font" for="patientName">Patient Name</label>
                  <input class="w-full outline-none border border-[#CACBE6] rounded-lg px-3 py-2.5 text-sm text-[#151E2C] outfit-font" id="patientName" type="text" placeholder="Patient Name" required>
            </div>
            <div class="space-y-1">
                  <label class="text-[#151E2C] text-sm outfit-font" for="patientNumber">Phone Number</label>
                  <input class="w-full outline-none border border-[#CACBE6] rounded-lg px-3 py-2.5 text-sm text-[#151E2C] outfit-font" type="number" id="patientNumber" placeholder="03*********" maxlength="11" required>
            </div>
            <button class="w-full transition-all p-2 py-3 rounded-lg block bg-gradient-to-r from-[#0755E9] to-[#05DC75] text-white">
                  <p class="text-center outfit-font">Add Now</p>
            </button>
      </form>
</section>


<script>
      let Chose_another_patient_main = document.getElementById('Chose_another_patient_main');

      function Chose_another_patient() {
      Chose_another_patient_main.classList.add("!top-[50%]");
      Chose_another_patient_main.classList.remove("-top-[50%]");
      }

      function Chose_another_patient_cancle() {
      Chose_another_patient_main.classList.remove("!top-[50%]");
      Chose_another_patient_main.classList.add("-top-[50%]");
      }
</script>


{% endblock baseBody %}